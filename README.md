
<!-- README.md is generated from README.Rmd. Please edit that file -->

# dcsbm

<!-- badges: start -->

[![R-CMD-check](https://github.com/mpff/dcsbm/workflows/R-CMD-check/badge.svg)](https://github.com/mpff/dcsbm/actions)
[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![Codecov test
coverage](https://codecov.io/gh/mpff/dcsbm/branch/main/graph/badge.svg)](https://app.codecov.io/gh/mpff/dcsbm?branch=main)
<!-- badges: end -->

The goal of dcsbm is to provide methods for estimating a two-way degree
corrected stochastic block model for directed, weighted graphs. Uses the
‘igraph’ library <https://igraph.org> for graph handling. See Peixoto
(2014) \<10.1103/PhysRevE.89.012804\> for details on the inference
algorithm.

## Installation

You can install the development version from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mpff/dcsbm")
```

## Example

This is a basic example which shows you how to solve a common problem:

``` r
library(dcsbm)
#> Loading required package: igraph
#> 
#> Attaching package: 'igraph'
#> The following objects are masked from 'package:stats':
#> 
#>     decompose, spectrum
#> The following object is masked from 'package:base':
#> 
#>     union
#> 
#> Attaching package: 'dcsbm'
#> The following object is masked from 'package:igraph':
#> 
#>     sbm

# Generate graph by a planted partition model and estimate an sbm.
g <- sample_dcppm(60, c=0.95, k=20, B=3, k_coef=1.5, directed=TRUE, loops=TRUE)
m <- sbm(g, degree_correction=TRUE, n.sweeps=5)
#>   |                                                               |                                                       |   0%  [ 60 -> 40 blocks ]  |                                                               |=                                                      |   2%  |                                                               |==                                                     |   3%  |                                                               |===                                                    |   5%  |                                                               |====                                                   |   7%  |                                                               |=====                                                  |   8%  |                                                               |======                                                 |  10%  |                                                               |======                                                 |  12%  |                                                               |=======                                                |  13%  |                                                               |========                                               |  15%  |                                                               |=========                                              |  17%  |                                                               |==========                                             |  18%  |                                                               |===========                                            |  20%  |                                                               |============                                           |  22%  |                                                               |=============                                          |  23%  |                                                               |==============                                         |  25%  |                                                               |===============                                        |  27%  |                                                               |================                                       |  28%  |                                                               |================                                       |  30%  |                                                               |=================                                      |  32%  |                                                               |==================                                     |  33%  |                                                               |===================                                    |  35%  |                                                               |====================                                   |  37%  |                                                               |=====================                                  |  38%  |                                                               |======================                                 |  40%  |                                                               |=======================                                |  42%  |                                                               |========================                               |  43%  |                                                               |=========================                              |  45%  |                                                               |==========================                             |  47%  |                                                               |===========================                            |  48%  |                                                               |============================                           |  50%  |                                                               |============================                           |  52%  |                                                               |=============================                          |  53%  |                                                               |==============================                         |  55%  |                                                               |===============================                        |  57%  |                                                               |================================                       |  58%  |                                                               |=================================                      |  60%  |                                                               |==================================                     |  62%  |                                                               |===================================                    |  63%  |                                                               |====================================                   |  65%  |                                                               |=====================================                  |  67%  |                                                               |======================================                 |  68%  |                                                               |======================================                 |  70%  |                                                               |=======================================                |  72%  |                                                               |========================================               |  73%  |                                                               |=========================================              |  75%  |                                                               |==========================================             |  77%  |                                                               |===========================================            |  78%  |                                                               |============================================           |  80%  |                                                               |=============================================          |  82%  |                                                               |==============================================         |  83%  |                                                               |===============================================        |  85%  |                                                               |================================================       |  87%  |                                                               |=================================================      |  88%  |                                                               |==================================================     |  90%  |                                                               |==================================================     |  92%  |                                                               |===================================================    |  93%  |                                                               |====================================================   |  95%  |                                                               |=====================================================  |  97%  |                                                               |====================================================== |  98%  |                                                               |=======================================================| 100%
#>   |                                                               |                                                       |   0%  [ 40 -> 27 blocks ]  |                                                               |=                                                      |   2%  |                                                               |===                                                    |   5%  |                                                               |====                                                   |   8%  |                                                               |======                                                 |  10%  |                                                               |=======                                                |  12%  |                                                               |========                                               |  15%  |                                                               |==========                                             |  18%  |                                                               |===========                                            |  20%  |                                                               |============                                           |  22%  |                                                               |==============                                         |  25%  |                                                               |===============                                        |  28%  |                                                               |================                                       |  30%  |                                                               |==================                                     |  32%  |                                                               |===================                                    |  35%  |                                                               |=====================                                  |  38%  |                                                               |======================                                 |  40%  |                                                               |=======================                                |  42%  |                                                               |=========================                              |  45%  |                                                               |==========================                             |  48%  |                                                               |============================                           |  50%  |                                                               |=============================                          |  52%  |                                                               |==============================                         |  55%  |                                                               |================================                       |  58%  |                                                               |=================================                      |  60%  |                                                               |==================================                     |  62%  |                                                               |====================================                   |  65%  |                                                               |=====================================                  |  68%  |                                                               |======================================                 |  70%  |                                                               |========================================               |  72%  |                                                               |=========================================              |  75%  |                                                               |===========================================            |  78%  |                                                               |============================================           |  80%  |                                                               |=============================================          |  82%  |                                                               |===============================================        |  85%  |                                                               |================================================       |  88%  |                                                               |==================================================     |  90%  |                                                               |===================================================    |  92%  |                                                               |====================================================   |  95%  |                                                               |====================================================== |  98%  |                                                               |=======================================================| 100%
#>   |                                                               |                                                       |   0%  [ 27 -> 18 blocks ]  |                                                               |==                                                     |   4%  |                                                               |====                                                   |   7%  |                                                               |======                                                 |  11%  |                                                               |========                                               |  15%  |                                                               |==========                                             |  19%  |                                                               |============                                           |  22%  |                                                               |==============                                         |  26%  |                                                               |================                                       |  30%  |                                                               |==================                                     |  33%  |                                                               |====================                                   |  37%  |                                                               |======================                                 |  41%  |                                                               |========================                               |  44%  |                                                               |==========================                             |  48%  |                                                               |=============================                          |  52%  |                                                               |===============================                        |  56%  |                                                               |=================================                      |  59%  |                                                               |===================================                    |  63%  |                                                               |=====================================                  |  67%  |                                                               |=======================================                |  70%  |                                                               |=========================================              |  74%  |                                                               |===========================================            |  78%  |                                                               |=============================================          |  81%  |                                                               |===============================================        |  85%  |                                                               |=================================================      |  89%  |                                                               |===================================================    |  93%  |                                                               |=====================================================  |  96%  |                                                               |=======================================================| 100%
#>   |                                                               |                                                       |   0%  [ 18 -> 12 blocks ]  |                                                               |===                                                    |   6%  |                                                               |======                                                 |  11%  |                                                               |=========                                              |  17%  |                                                               |============                                           |  22%  |                                                               |===============                                        |  28%  |                                                               |==================                                     |  33%  |                                                               |=====================                                  |  39%  |                                                               |========================                               |  44%  |                                                               |============================                           |  50%  |                                                               |===============================                        |  56%  |                                                               |==================================                     |  61%  |                                                               |=====================================                  |  67%  |                                                               |========================================               |  72%  |                                                               |===========================================            |  78%  |                                                               |==============================================         |  83%  |                                                               |=================================================      |  89%  |                                                               |====================================================   |  94%  |                                                               |=======================================================| 100%
#>   |                                                                |                                                        |   0%  [ 12 -> 8 blocks ]  |                                                                |=====                                                   |   8%  |                                                                |=========                                               |  17%  |                                                                |==============                                          |  25%  |                                                                |===================                                     |  33%  |                                                                |=======================                                 |  42%  |                                                                |============================                            |  50%  |                                                                |=================================                       |  58%  |                                                                |=====================================                   |  67%  |                                                                |==========================================              |  75%  |                                                                |===============================================         |  83%  |                                                                |===================================================     |  92%  |                                                                |========================================================| 100%
#>   |                                                                 |                                                         |   0%  [ 8 -> 5 blocks ]  |                                                                 |=======                                                  |  12%  |                                                                 |==============                                           |  25%  |                                                                 |=====================                                    |  38%  |                                                                 |============================                             |  50%  |                                                                 |====================================                     |  62%  |                                                                 |===========================================              |  75%  |                                                                 |==================================================       |  88%  |                                                                 |=========================================================| 100%
#>   |                                                                 |                                                         |   0%  [ 5 -> 3 blocks ]  |                                                                 |===========                                              |  20%  |                                                                 |=======================                                  |  40%  |                                                                 |==================================                       |  60%  |                                                                 |==============================================           |  80%  |                                                                 |=========================================================| 100%
#>   |                                                                 |                                                         |   0%  [ 3 -> 2 blocks ]  |                                                                 |===================                                      |  33%  |                                                                 |======================================                   |  67%  |                                                                 |=========================================================| 100%
#>   |                                                                 |                                                         |   0%  [ 2 -> 1 blocks ]  |                                                                 |============================                             |  50%  |                                                                 |=========================================================| 100%

# Plot result for 3 blocks.
plot(g, vertex.color = m$partition[[8]], vertex.label = NA)
```

<img src="man/figures/README-example-1.png" width="66%" />

``` r

# Plot entropy delta by number of blocks.
plot(m$block_sequence, m$entropy_delta, type = "line")
#> Warning in plot.xy(xy, type, ...): plot type 'line' will be truncated to first
#> character
```

<img src="man/figures/README-example-2.png" width="66%" />
